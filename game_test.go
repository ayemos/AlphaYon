package main

import (
	"testing"
)

type boardTest struct {
	pins   []rune
	winner Color
}

var boardsToTest = []boardTest{
	boardTest{
		[]rune{
			'.', '.', '.', '.',
			'.', '.', '.', '.',
			'.', '.', '.', '.',
			'.', '.', '.', '.',

			'.', '.', '.', '.',
			'.', '.', '.', '.',
			'.', '.', '.', '.',
			'.', '.', '.', '.',

			'.', '.', '.', '.',
			'.', '.', '.', '.',
			'.', '.', '.', '.',
			'.', '.', '.', '.',

			'.', '.', '.', '.',
			'.', '.', '.', '.',
			'.', '.', '.', '.',
			'.', '.', '.', '.'}, EMPTY},

	boardTest{
		[]rune{
			'b', '.', '.', '.',
			'b', '.', '.', '.',
			'b', '.', '.', '.',
			'.', '.', '.', '.',

			'.', '.', '.', '.',
			'.', '.', '.', '.',
			'.', '.', '.', '.',
			'.', '.', '.', '.',

			'.', '.', '.', '.',
			'.', '.', '.', '.',
			'.', '.', '.', '.',
			'.', '.', '.', '.',

			'.', '.', '.', '.',
			'.', '.', '.', '.',
			'.', '.', '.', '.',
			'.', '.', '.', '.'}, EMPTY},

	boardTest{
		[]rune{
			'b', '.', '.', '.',
			'b', '.', '.', '.',
			'b', '.', '.', '.',
			'b', '.', '.', '.',

			'.', '.', '.', '.',
			'.', '.', '.', '.',
			'.', '.', '.', '.',
			'.', '.', '.', '.',

			'.', '.', '.', '.',
			'.', '.', '.', '.',
			'.', '.', '.', '.',
			'.', '.', '.', '.',

			'.', '.', '.', '.',
			'.', '.', '.', '.',
			'.', '.', '.', '.',
			'.', '.', '.', '.'}, BLACK},

	boardTest{
		[]rune{
			'w', '.', '.', '.',
			'w', '.', '.', '.',
			'w', '.', '.', '.',
			'w', '.', '.', '.',

			'.', '.', '.', '.',
			'.', '.', '.', '.',
			'.', '.', '.', '.',
			'.', '.', '.', '.',

			'.', '.', '.', '.',
			'.', '.', '.', '.',
			'.', '.', '.', '.',
			'.', '.', '.', '.',

			'.', '.', '.', '.',
			'.', '.', '.', '.',
			'.', '.', '.', '.',
			'.', '.', '.', '.'}, WHITE},

	boardTest{
		[]rune{
			'b', 'b', 'b', 'b',
			'.', '.', '.', '.',
			'.', '.', '.', '.',
			'.', '.', '.', '.',

			'.', '.', '.', '.',
			'.', '.', '.', '.',
			'.', '.', '.', '.',
			'.', '.', '.', '.',

			'.', '.', '.', '.',
			'.', '.', '.', '.',
			'.', '.', '.', '.',
			'.', '.', '.', '.',

			'.', '.', '.', '.',
			'.', '.', '.', '.',
			'.', '.', '.', '.',
			'.', '.', '.', '.'}, BLACK},

	boardTest{
		[]rune{
			'b', '.', '.', '.',
			'.', 'b', '.', '.',
			'.', '.', 'b', '.',
			'.', '.', '.', 'b',

			'.', '.', '.', '.',
			'.', '.', '.', '.',
			'.', '.', '.', '.',
			'.', '.', '.', '.',

			'.', '.', '.', '.',
			'.', '.', '.', '.',
			'.', '.', '.', '.',
			'.', '.', '.', '.',

			'.', '.', '.', '.',
			'.', '.', '.', '.',
			'.', '.', '.', '.',
			'.', '.', '.', '.'}, BLACK},

	boardTest{
		[]rune{
			'b', '.', '.', '.',
			'.', '.', '.', '.',
			'.', '.', '.', '.',
			'.', '.', '.', '.',

			'b', '.', '.', '.',
			'.', '.', '.', '.',
			'.', '.', '.', '.',
			'.', '.', '.', '.',

			'b', '.', '.', '.',
			'.', '.', '.', '.',
			'.', '.', '.', '.',
			'.', '.', '.', '.',

			'b', '.', '.', '.',
			'.', '.', '.', '.',
			'.', '.', '.', '.',
			'.', '.', '.', '.'}, BLACK},

	boardTest{
		[]rune{
			'b', '.', '.', '.',
			'.', '.', '.', '.',
			'.', '.', '.', '.',
			'.', '.', '.', '.',

			'.', '.', '.', '.',
			'.', 'b', '.', '.',
			'.', '.', '.', '.',
			'.', '.', '.', '.',

			'.', '.', '.', '.',
			'.', '.', '.', '.',
			'.', '.', 'b', '.',
			'.', '.', '.', '.',

			'.', '.', '.', '.',
			'.', '.', '.', '.',
			'.', '.', '.', '.',
			'.', '.', '.', 'b'}, BLACK},

	boardTest{
		[]rune{
			'b', 'w', 'b', 'w',
			'w', 'b', 'w', 'b',
			'w', 'b', 'w', 'b',
			'w', 'w', 'b', 'w',

			'b', 'w', 'b', 'b',
			'.', 'w', '.', '.',
			'.', 'w', '.', '.',
			'.', 'w', '.', '.',

			'.', '.', '.', '.',
			'.', '.', '.', '.',
			'.', '.', '.', '.',
			'.', '.', '.', '.',

			'.', '.', '.', '.',
			'.', '.', '.', '.',
			'.', '.', '.', '.',
			'.', '.', '.', '.'}, WHITE},
}

func TestJudge(t *testing.T) {
	for _, test := range boardsToTest {
		b := NewBoard(4)
		err := b.loadArray(test.pins)

		if err != nil {
			t.Errorf("Setup error: %s.", err)
		}

		winner := Judge(b)

		if winner != test.winner {
			t.Errorf("Judge(%s) = %s, want %s.", b, winner, test.winner)
		}
	}
}
